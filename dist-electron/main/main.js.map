{"version":3,"file":"main.js","sources":["../../electron/handlers/fileHandlers.ts","../../electron/main.ts"],"sourcesContent":["/**\r\n * File: electron/handlers/fileHandlers.ts\r\n * Description: Main process handlers for file operations\r\n */\r\n\r\nimport { ipcMain, dialog } from \"electron\";\r\nimport fs from \"fs/promises\";\r\nimport path from \"path\";\r\n\r\n// Define channel names as constants\r\nexport const FILE_CHANNELS = {\r\n  SELECT_FILE: \"file:select\",\r\n  READ_FILE: \"file:read\",\r\n  WRITE_FILE: \"file:write\",\r\n  GET_FILES: \"file:get-all\",\r\n  DELETE_FILE: \"file:delete\",\r\n  GET_FILE_INFO: \"file:info\",\r\n} as const;\r\n\r\nexport function setupFileHandlers() {\r\n  // Handler for file selection dialog\r\n  ipcMain.handle(\r\n    FILE_CHANNELS.SELECT_FILE,\r\n    async (_, options?: { multiple?: boolean }) => {\r\n      const result = await dialog.showOpenDialog({\r\n        properties: options?.multiple\r\n          ? [\"openFile\", \"multiSelections\"]\r\n          : [\"openFile\"],\r\n      });\r\n\r\n      return result.filePaths;\r\n    }\r\n  );\r\n\r\n  // Handler for reading file contents\r\n  ipcMain.handle(FILE_CHANNELS.READ_FILE, async (_, filePath: string) => {\r\n    try {\r\n      const content = await fs.readFile(filePath);\r\n      const stats = await fs.stat(filePath);\r\n\r\n      return {\r\n        content,\r\n        name: path.basename(filePath),\r\n        path: filePath,\r\n        size: stats.size,\r\n        lastModified: stats.mtime,\r\n      };\r\n    } catch (error: unknown) {\r\n      const message =\r\n        error instanceof Error ? error.message : \"Unknown error occurred\";\r\n      throw new Error(`Failed to read file: ${message}`);\r\n    }\r\n  });\r\n\r\n  // Handler for writing files\r\n  ipcMain.handle(FILE_CHANNELS.WRITE_FILE, async (_, { filePath, content }) => {\r\n    try {\r\n      await fs.writeFile(filePath, content);\r\n      const stats = await fs.stat(filePath);\r\n\r\n      return {\r\n        name: path.basename(filePath),\r\n        path: filePath,\r\n        size: stats.size,\r\n        lastModified: stats.mtime,\r\n      };\r\n    } catch (error: unknown) {\r\n      const message =\r\n        error instanceof Error ? error.message : \"Unknown error occurred\";\r\n      throw new Error(`Failed to write file: ${message}`);\r\n    }\r\n  });\r\n\r\n  // Handler for getting all files in a directory\r\n  ipcMain.handle(FILE_CHANNELS.GET_FILES, async (_, dirPath: string) => {\r\n    try {\r\n      const entries = await fs.readdir(dirPath, { withFileTypes: true });\r\n\r\n      const files = await Promise.all(\r\n        entries\r\n          .filter((entry) => entry.isFile())\r\n          .map(async (entry) => {\r\n            const filePath = path.join(dirPath, entry.name);\r\n            const stats = await fs.stat(filePath);\r\n\r\n            return {\r\n              name: entry.name,\r\n              path: filePath,\r\n              size: stats.size,\r\n              lastModified: stats.mtime,\r\n              type:\r\n                path.extname(entry.name).toLowerCase().slice(1) || \"unknown\",\r\n            };\r\n          })\r\n      );\r\n\r\n      return files;\r\n    } catch (error: unknown) {\r\n      const message =\r\n        error instanceof Error ? error.message : \"Unknown error occurred\";\r\n      throw new Error(`Failed to get files: ${message}`);\r\n    }\r\n  });\r\n\r\n  // Handler for deleting files\r\n  ipcMain.handle(FILE_CHANNELS.DELETE_FILE, async (_, filePath: string) => {\r\n    try {\r\n      await fs.unlink(filePath);\r\n      return true;\r\n    } catch (error: unknown) {\r\n      const message =\r\n        error instanceof Error ? error.message : \"Unknown error occurred\";\r\n      throw new Error(`Failed to delete file: ${message}`);\r\n    }\r\n  });\r\n\r\n  // Handler for getting file information\r\n  ipcMain.handle(FILE_CHANNELS.GET_FILE_INFO, async (_, filePath: string) => {\r\n    try {\r\n      const stats = await fs.stat(filePath);\r\n\r\n      return {\r\n        name: path.basename(filePath),\r\n        path: filePath,\r\n        size: stats.size,\r\n        lastModified: stats.mtime,\r\n        type: path.extname(filePath).toLowerCase().slice(1) || \"unknown\",\r\n      };\r\n    } catch (error: unknown) {\r\n      const message =\r\n        error instanceof Error ? error.message : \"Unknown error occurred\";\r\n      throw new Error(`Failed to get file info: ${message}`);\r\n    }\r\n  });\r\n}\r\n","import { app, BrowserWindow } from \"electron\";\r\nimport * as path from \"path\";\r\nimport { fileURLToPath } from \"url\";\r\nimport { setupFileHandlers } from \"./handlers/fileHandlers\";\r\n\r\nconst __filename = fileURLToPath(import.meta.url);\r\nconst __dirname = path.dirname(__filename);\r\n\r\nprocess.env.DIST_ELECTRON = path.join(__dirname, \"..\");\r\nprocess.env.DIST = path.join(process.env.DIST_ELECTRON, \"../dist\");\r\nprocess.env.VITE_PUBLIC = app.isPackaged\r\n  ? process.env.DIST\r\n  : path.join(process.env.DIST_ELECTRON, \"../public\");\r\n\r\nlet mainWindow: BrowserWindow | null = null;\r\n\r\n// Setup file handlers before app is ready\r\nsetupFileHandlers();\r\n\r\nasync function createWindow() {\r\n  // Choose preload path based on whether the app is packaged\r\n  const preloadPath = app.isPackaged\r\n    ? path.join(__dirname, \"../preload/index.js\")\r\n    : path.join(__dirname, \"../electron/preload.js\"); // or preload.ts if you have a way to run it directly\r\n\r\n  mainWindow = new BrowserWindow({\r\n    width: 1200,\r\n    height: 800,\r\n    webPreferences: {\r\n      preload: preloadPath,\r\n      nodeIntegration: false,\r\n      contextIsolation: true,\r\n    },\r\n  });\r\n\r\n  // Load the app\r\n  if (!app.isPackaged) {\r\n    mainWindow.loadURL(process.env.VITE_DEV_SERVER_URL!);\r\n  } else {\r\n    mainWindow.loadFile(path.join(process.env.DIST!, \"index.html\"));\r\n  }\r\n\r\n  // Prevent opening DevTools with keyboard shortcuts\r\n  mainWindow.webContents.on(\"before-input-event\", (event, input) => {\r\n    if (\r\n      (input.control || input.meta) &&\r\n      input.shift &&\r\n      input.key.toLowerCase() === \"i\"\r\n    ) {\r\n      event.preventDefault();\r\n    }\r\n  });\r\n}\r\n\r\napp.whenReady().then(createWindow);\r\n\r\n// Quit when all windows are closed.\r\napp.on(\"window-all-closed\", () => {\r\n  if (process.platform !== \"darwin\") {\r\n    app.quit();\r\n  }\r\n});\r\n\r\napp.on(\"activate\", () => {\r\n  if (mainWindow === null) {\r\n    createWindow();\r\n  }\r\n});\r\n"],"names":["path"],"mappings":"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"}